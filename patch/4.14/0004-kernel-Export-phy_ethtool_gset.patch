From b7c5613887be25b3862b19157b77ea6621627ccb Mon Sep 17 00:00:00 2001
From: jollaman999 <admin@jollaman999.com>
Date: Tue, 5 Jun 2018 13:34:08 +0900
Subject: [PATCH 4/5] kernel: Export phy_ethtool_gset

phy_ethtool_gset is needed for ar71xx.

Signed-off-by: jollaman999 <admin@jollaman999.com>
---
 .../generic/pending-4.14/701-phy_extension.patch     | 12 +++++++++---
 1 file changed, 9 insertions(+), 3 deletions(-)

diff --git a/target/linux/generic/pending-4.14/701-phy_extension.patch b/target/linux/generic/pending-4.14/701-phy_extension.patch
index 1b380e24a9..f1dfac67ec 100644
--- a/target/linux/generic/pending-4.14/701-phy_extension.patch
+++ b/target/linux/generic/pending-4.14/701-phy_extension.patch
@@ -9,11 +9,11 @@ Signed-off-by: John Crispin <john@phrozen.org>
 
 --- a/drivers/net/phy/phy.c
 +++ b/drivers/net/phy/phy.c
-@@ -382,6 +382,73 @@ void phy_ethtool_ksettings_get(struct ph
+@@ -382,6 +382,74 @@ void phy_ethtool_ksettings_get(struct phy_device *phydev,
  }
  EXPORT_SYMBOL(phy_ethtool_ksettings_get);
  
-+static int phy_ethtool_gset(struct phy_device *phydev, struct ethtool_cmd *cmd)
++int phy_ethtool_gset(struct phy_device *phydev, struct ethtool_cmd *cmd)
 +{
 +	cmd->supported = phydev->supported;
 +
@@ -35,6 +35,7 @@ Signed-off-by: John Crispin <john@phrozen.org>
 +
 +	return 0;
 +}
++EXPORT_SYMBOL(phy_ethtool_gset);
 +
 +int phy_ethtool_ioctl(struct phy_device *phydev, void *useraddr)
 +{
@@ -85,7 +86,12 @@ Signed-off-by: John Crispin <john@phrozen.org>
   * @phydev: the phy_device struct
 --- a/include/linux/phy.h
 +++ b/include/linux/phy.h
-@@ -905,6 +905,7 @@ void phy_ethtool_ksettings_get(struct ph
+@@ -901,10 +901,12 @@ void phy_start_machine(struct phy_device *phydev);
+ void phy_stop_machine(struct phy_device *phydev);
+ void phy_trigger_machine(struct phy_device *phydev, bool sync);
+ int phy_ethtool_sset(struct phy_device *phydev, struct ethtool_cmd *cmd);
++int phy_ethtool_gset(struct phy_device *phydev, struct ethtool_cmd *cmd);
+ void phy_ethtool_ksettings_get(struct phy_device *phydev,
  			       struct ethtool_link_ksettings *cmd);
  int phy_ethtool_ksettings_set(struct phy_device *phydev,
  			      const struct ethtool_link_ksettings *cmd);
-- 
2.17.1

